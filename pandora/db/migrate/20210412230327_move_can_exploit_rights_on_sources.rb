class MoveCanExploitRightsOnSources < ActiveRecord::Migration[5.2]
  def change
    add_column :sources, :can_exploit_rights, :boolean

    Institution.find_each do |institution|
      if institution.can_exploit_rights
        institution.sources.each do |source|
          source.update_column :can_exploit_rights, true
        end
      end
    end

    remove_column :institutions, :can_exploit_rights
  end
end
